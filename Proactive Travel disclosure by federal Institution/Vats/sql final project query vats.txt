Question for query 
Suppose you want to find all the organizations along with their total 
costs where the average cost is above a certain threshold.


Ans 
SELECT
    org_id,
    org_owner_title,
    org_owner,
    total_cost
FROM organization o
INNER JOIN 
(
    SELECT
        ref_id,
        SUM(total) AS total_cost
    FROM cost
    GROUP BY ref_id
    HAVING AVG(total) > 12000  
) c ON o.ref_id = c.ref_id;


Insight:

The subquery calculates the total cost for each ref_id in the cost table and 
filters the results using the HAVING clause to include only those with an average total 
cost above a certain threshold.

The main query then joins the organization table with the subquery results based on the 
ref_id and retrieves the organization information along with the total cost.